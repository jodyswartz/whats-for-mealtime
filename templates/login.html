<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Login</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; padding: 24px; }
    .wrap { max-width: 520px; margin: 0 auto; }
    .card { border: 1px solid #ddd; border-radius: 14px; padding: 16px; }
    .error { color: #b00020; margin: 10px 0; }
    label { display:block; font-weight: 650; margin: 12px 0 6px; }
    input { width: 100%; padding: 14px 12px; font-size: 18px; border-radius: 12px; border: 1px solid #ccc; }
    button { margin-top: 12px; width: 100%; padding: 14px 12px; font-size: 18px; font-weight: 650; border-radius: 12px; border: 0; background: #111; color: #fff; }
    .qrbox { display:inline-block; background:#fff; padding:16px; border-radius:14px; border:1px solid #ddd; }
    img { display:block; width:360px; height:360px; image-rendering: pixelated; }
    code { user-select: all; background: #f6f6f6; padding: 2px 6px; border-radius: 6px; }
    .hint { color:#444; line-height: 1.4; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Login</h1>

    <div class="card">
      {% if error %}<div class="error">{{ error }}</div>{% endif %}

      <form method="POST" action="/login">
        <label for="code">6-digit code</label>
        <input id="code" name="code" inputmode="numeric" autocomplete="one-time-code" placeholder="123456" required />
        <button type="submit">Verify</button>
      </form>

      {% if show_qr %}
        <hr style="margin:18px 0; border:none; border-top:1px solid #eee;" />

        <p class="hint"><strong>Scan this once</strong> using your authenticator app’s “Scan QR” feature (Google Authenticator / 1Password / Authy).</p>

        <div class="qrbox">
          <img src="{{ url_for('totp_qr') }}" alt="TOTP QR code">
        </div>

        <p class="hint" style="margin-top:14px;">
          If scanning still fails, add it manually:
        </p>
        <ul class="hint">
          <li><strong>Issuer:</strong> {{ issuer }}</li>
          <li><strong>Account:</strong> {{ account }}</li>
          <li><strong>Secret:</strong> <code>{{ secret }}</code></li>
          <li><strong>Type:</strong> Time-based (TOTP)</li>
          <li><strong>Digits:</strong> 6</li>
          <li><strong>Period:</strong> 30 seconds</li>
          <li><strong>Algorithm:</strong> SHA1</li>
        </ul>
      {% endif %}
    </div>
  </div>
</body>
</html>